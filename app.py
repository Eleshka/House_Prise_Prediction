# app.py
import streamlit as st
import pandas as pd
import numpy as np
import joblib

# ---- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏ ----
@st.cache_resource  # –ö–µ—à–∏—Ä—É–µ–º, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
def load_model():
    model = joblib.load('full_pipeline.joblib')
    return model

# ---- –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ----
model = load_model()
st.title("üè† –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")

# ---- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ CSV ----
uploaded_file = st.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV-—Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏", type=['csv'])
if uploaded_file:
    df_input = pd.read_csv(uploaded_file)
    # –î–∞–ª–µ–µ –ª–æ–≥–∏–∫–∞ –∏–∑ main.py –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
    # ... (–≤–∞—à –∫–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏) ...

    if st.button("–°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ"):
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ–ª–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        prediction = model.predict(df_input)
        # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        st.write(f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞: {np.exp(prediction)}")  # –ï—Å–ª–∏ —Ü–µ–ª—å –±—ã–ª–∞ –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–µ